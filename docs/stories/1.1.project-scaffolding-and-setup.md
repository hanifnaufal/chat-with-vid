<!-- Powered by BMAD™ Core -->

# Story 1.1: Project Scaffolding & Setup

## Status
Ready for Review

## Story
**As a** developer,
**I want** a complete project structure with all necessary dependencies and local services running in Docker,
**so that** I can begin developing features in a consistent and reproducible environment.

## Acceptance Criteria
1. A monorepo is created containing separate packages for the api (FastAPI) and web (Next.js) applications.
2. All dependencies listed in the technical assumptions (Next.js, FastAPI, etc.) are installed.
3. A docker-compose.yml file is created to run PostgreSQL database, FastAPI backend, and Next.js frontend locally.
4. The web and api applications can be started successfully with a single command using Docker.
5. A README.md file is created with clear instructions for initial setup using Docker (as per FR8).

## Tasks / Subtasks
- [x] Create monorepo structure with apps/api and apps/web directories (AC: 1)
  - [x] Set up apps/api directory for FastAPI backend
  - [x] Set up apps/web directory for Next.js frontend
- [x] Configure backend dependencies with Poetry (AC: 2)
  - [x] Create pyproject.toml with required dependencies (FastAPI, LangChain, SQLAlchemy, etc.)
  - [x] Install all backend dependencies
- [x] Configure frontend dependencies with npm (AC: 2)
  - [x] Initialize Next.js application in apps/web
  - [x] Install all frontend dependencies
- [x] Create docker-compose.yml for all services (AC: 3)
  - [x] Define PostgreSQL service with appropriate configuration
  - [x] Define FastAPI backend service with proper build configuration
  - [x] Define Next.js frontend service with proper build configuration
  - [x] Set up environment variables for all services
  - [x] Configure proper networking between services
- [x] Implement startup scripts for both applications (AC: 4)
  - [x] Create script to start all services with Docker Compose
  - [x] Create script to start services in development mode with hot reloading
- [x] Create comprehensive README.md with setup instructions (AC: 5)
  - [x] Include Docker as the primary method for running the application
  - [x] Document how to start all services with a single command
  - [x] Include alternative direct installation steps for development
  - [x] Add basic usage instructions

## Dev Notes
### Source Tree Structure
The project will follow a monorepo structure with separate directories for the API and web applications:

```
chat-with-vid/
├── apps/
│   ├── api/                  # Python/FastAPI Backend
│   │   ├── app/
│   │   │   ├── __init__.py
│   │   │   ├── main.py         # FastAPI app instance and middleware
│   │   │   ├── api/            # API Routers (Endpoints)
│   │   │   │   └── v1/
│   │   │   │       └── chats.py
│   │   │   ├── core/           # Core logic (config, db session)
│   │   │   ├── models/       # SQLAlchemy ORM models
│   │   │   ├── schemas/        # Pydantic schemas (for API validation)
│   │   │   ├── services/       # Business logic (Chat, LLM, Video Processing)
│   │   │   └── repository/     # Data access layer
│   │   ├── tests/              # Pytest tests
│   │   ├── .env.example
│   │   └── pyproject.toml      # Poetry config for backend
│   │
│   └── web/                  # Next.js Frontend (as per ui-architecture.md)
│       ├── src/
│       │   ├── app/
│       │   ├── components/
│       │   └── lib/
│       ├── .env.local.example
│       └── package.json
│
├── packages/
│   └── shared-types/         # (Optional) For sharing types between FE/BE
│
├── .gitignore
├── docker-compose.yml        # For all services (PostgreSQL, FastAPI, Next.js)
└── README.md
```

[Source: architecture/10-source-tree.md]

### Technology Stack
- **Backend**: Python 3.12 with FastAPI 0.111.0 framework (running in Docker)
- **Frontend**: Next.js for the web application (running in Docker)
- **Database**: PostgreSQL managed via Docker
- **LLM Integration**: LangChain with langchain-google-genai
- **ORM**: SQLAlchemy 2.0 with psycopg (v3) driver
- **Dependency Management**: Poetry for backend, npm for frontend
- **Containerization**: Docker and Docker Compose for local development
- **Code Quality**: Ruff & Black for linting and formatting

[Source: architecture/3-tech-stack.md]

### Coding Standards
- All backend code must be written in Python ~3.12
- Code must be formatted with Black and pass all linting checks from Ruff
- Tests must be located in the apps/api/tests directory following the naming convention test_*.py
- Use the Repository Pattern for all database interactions
- Centralized Exception Handling with custom business exceptions
- Structured Logging Only - do not use print()
- Secure API Key Handling via configuration service
- Use LangChain Chains for all LLM interactions

[Source: architecture/13-coding-standards.md]

### Testing Standards
- Follow Test-Driven Development (TDD) methodology with Red-Green-Refactor cycle
- Use pytest as the testing framework
- Tests must be located in apps/api/tests directory, mirroring the application structure
- Use unittest.mock or pytest-mock for mocking
- AI Agent must follow TDD cycle: write failing test first, then implementation, then refactor
- Integration tests will test service layer against a real database instance
- Use pytest fixtures for test data management
- CI pipeline with GitHub Actions will run entire test suite and linter checks on every pull request

[Source: architecture/14-test-strategy-and-standards.md]

### Project Architecture
- **Architectural Style**: Decoupled Client-Server with Next.js frontend and FastAPI backend
- **Repository Structure**: Monorepo to keep api and web applications together
- **Service Architecture**: FastAPI as dedicated backend API server handling requests, database interactions, and interfacing with external services
- **Containerization**: All services (PostgreSQL, FastAPI, Next.js) will run in Docker containers for local development
- **Development Workflow**: Docker Compose will be used to orchestrate all services with a single command
- **Data Flow**: User submits URL via frontend → request to FastAPI backend → async job fetches YouTube data → transcript sent to Gemini API for analysis → frontend polls backend for status updates

[Source: architecture/2-high-level-architecture.md]

## Change Log
| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-09-15 | 1.0 | Initial story creation | BMAD Agent |
| 2025-09-15 | 1.1 | Completed story draft checklist validation | BMAD Agent |
| 2025-09-15 | 1.2 | Updated to run all services in Docker containers | Scrum Master |

## Dev Agent Record
### Agent Model Used
James (Full Stack Developer)

### Debug Log References


### Completion Notes List
- Created monorepo structure with apps/api and apps/web directories
- Set up complete FastAPI backend structure with proper directory hierarchy
- Set up complete Next.js frontend structure with proper directory hierarchy
- Configured backend dependencies with Poetry including FastAPI, LangChain, SQLAlchemy, and testing tools
- Configured frontend dependencies with npm including Next.js, React, and ESLint
- Created docker-compose.yml with PostgreSQL, FastAPI backend, and Next.js frontend services
- Implemented startup scripts (start.sh and dev.sh) for both production and development modes
- Created comprehensive README.md with setup instructions
- Verified all services start successfully and pass basic tests
- Backend tests pass with pytest
- Frontend builds successfully with Next.js

### File List
- apps/api/app/main.py
- apps/api/app/api/v1/chats.py
- apps/api/app/__init__.py
- apps/api/tests/test_main.py
- apps/api/pyproject.toml
- apps/api/.env.example
- apps/web/src/app/page.js
- apps/web/src/app/layout.js
- apps/web/src/components/VideoUpload.js
- apps/web/package.json
- apps/web/.env.local.example
- docker-compose.yml
- docker-compose.dev.yml
- start.sh
- dev.sh
- README.md
- apps/api/Dockerfile
- apps/api/Dockerfile.dev
- apps/web/Dockerfile
- apps/web/Dockerfile.dev

## QA Results
